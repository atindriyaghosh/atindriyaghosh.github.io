<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <!-- (1) Optimize for mobile versions: http://goo.gl/EOpFl -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <!-- (1) force latest IE rendering engine: bit.ly/1c8EiC9 -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <title>Recommendation Systems 3 - User-based Recommendations</title>
    <meta name="description" content="" />

    <meta name="HandheldFriendly" content="True" />
    <meta name="MobileOptimized" content="320" />
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="Recommendation Systems 3 - User-based Recommendations">
    <meta name="twitter:description" content="">
    <meta name="twitter:site" content="https://www.atindriyaghosh.com">
    <meta name="twitter:creator" content="@A3Ghosh">
    <meta name="google-site-verification" content="">
    <meta property="fb:admins" content="">
    <meta property="og:type" content="article">
    <meta property="og:title" content="Recommendation Systems 3 - User-based Recommendations">
    <meta property="og:description" content="">

    <link rel="shortcut icon" href="../favicon.ico">
    <link rel="stylesheet" href="../assets/js/styles/obsidian.css">
    <link rel="stylesheet" href="http://brick.a.ssl.fastly.net/Linux+Libertine:400,400i,700,700i/Open+Sans:400,400i,700,700i">
    <link href="http://netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.min.css" rel="stylesheet">
    <link rel="stylesheet" type="text/css" media="screen" href="../assets/css/main.css" />
    <link rel="stylesheet" type="text/css" media="print" href="../assets/css/print.css" />
	<!-- Pushy CSS -->
    <link rel="stylesheet" href="../assets/css/pushy.css">
    <script src="https://code.jquery.com/jquery-1.11.0.min.js"></script>
    <link rel="canonical" href="https://www.atindriyaghosh.com/recommendation-systems-3-user-based-recommendations/" />
    
    <meta property="og:site_name" content="Atindriya Ghosh" />
    <meta property="og:type" content="article" />
    <meta property="og:title" content="Recommendation Systems 3 - User-based Recommendations" />
    <meta property="og:description" content="In the last post, I covered three different algorithms for calculating similarity scores. Now, lets see how these similarity scores can be used to generate User-based recommendations. Generating User-based Recommendations Similarity scores help us understand the similarity between different users..." />
    <meta property="og:url" content="https://www.atindriyaghosh.com/recommendation-systems-3-user-based-recommendations/" />
    <meta property="article:published_time" content="2014-12-21T09:24:00.000Z" />
    <meta property="article:modified_time" content="2015-02-07T19:44:57.511Z" />
    <meta property="article:tag" content="Python" />
    <meta property="article:tag" content="Recommendation Systems" />
    <meta property="article:tag" content="Collaborative Filtering" />
    <meta property="article:tag" content="Machine Learning" />
    <meta property="article:tag" content="User-based CF" />
    
    <meta name="twitter:card" content="content" />
    <meta name="twitter:title" content="Recommendation Systems 3 - User-based Recommendations" />
    <meta name="twitter:description" content="In the last post, I covered three different algorithms for calculating similarity scores. Now, lets see how these similarity scores can be used to generate User-based recommendations. Generating User-based Recommendations Similarity scores help us understand the similarity between different users..." />
    <meta name="twitter:url" content="https://www.atindriyaghosh.com/recommendation-systems-3-user-based-recommendations/" />
    
    <script type="application/ld+json">
{
    "@context": "http://schema.org",
    "@type": "Article",
    "publisher": "Atindriya Ghosh",
    "author": {
        "@type": "Person",
        "name": "Atindriya Ghosh",
        "image": "https://www.atindriyaghosh.com/content/images/2015/02/Self-1.jpg",
        "url": "https://www.atindriyaghosh.com/author/atindriya-ghosh",
        "sameAs": null
    },
    "headline": "Recommendation Systems 3 - User-based Recommendations",
    "url": "https://www.atindriyaghosh.com/recommendation-systems-3-user-based-recommendations/",
    "datePublished": "2014-12-21T09:24:00.000Z",
    "dateModified": "2015-02-07T19:44:57.511Z",
    "keywords": "Python, Recommendation Systems, Collaborative Filtering, Machine Learning, User-based CF",
    "description": "In the last post, I covered three different algorithms for calculating similarity scores. Now, lets see how these similarity scores can be used to generate User-based recommendations. Generating User-based Recommendations Similarity scores help us understand the similarity between different users"
}
    </script>

    <meta name="generator" content="Ghost 0.5" />
    <link rel="alternate" type="application/rss+xml" title="Atindriya Ghosh" href="../rss" />
</head>
<body class="post-template tag-python tag-recommendation-systems tag-collaborative-filtering tag-machine-learning tag-user-based-cf">
	<!-- Pushy Menu -->
    <nav class="pushy pushy-left">
        <ul>
			<li><a href=".."><span class="fa fa-home fa-2x"></span>&nbsp;&nbsp;&nbsp;&nbsp;Home</a></li>
            <li><a href="../aboutme"><span class="fa fa-user fa-2x"></span>&nbsp;&nbsp;&nbsp;&nbsp;About Me</a></li>
			<li>
			<div id="at_search">
				<form>
				  <input type="text" id="search-field" placeholder="Search" autocomplete="off" />
				</form>
				<div id="results" class="at_search_results"></div>
			</div>
			</li>
        </ul>
    </nav>

    <!-- Site Overlay -->
    <div class="site-overlay"></div>
	
	<div id="container">
		<!-- Menu Button -->
		<div class="menu-btn logo-readium logo"><span class="logo"></span></div>
		

<main role="main">
	<!-- Added this fix since IE doesn't support main tag -->
	<div class="content">

		<article class="post tag-python tag-recommendation-systems tag-collaborative-filtering tag-machine-learning tag-user-based-cf">



			<div class="noarticleimage">
				<div class="post-meta">
					<h1 class="post-title">Recommendation Systems 3 - User-based Recommendations</h1>
					<div class="cf post-meta-text">
						<div class="author-image" style="background-image: url(../content/images/2015/02/Self-1.jpg)">Blog Logo</div>
						<h4 class="author-name" itemprop="author" itemscope itemtype="http://schema.org/Person"><a href="../author/atindriya-ghosh">Atindriya Ghosh</a></h4> on
						<time datetime="2014-12-21">21 Dec 2014</time>, tagged on <span class="post-tag-python"><a href="../tag/python">Python</a></span><span class="post-tag-recommendation-systems">, <a href="../tag/recommendation-systems">Recommendation Systems</a></span><span class="post-tag-collaborative-filtering">, <a href="../tag/collaborative-filtering">Collaborative Filtering</a></span><span class="post-tag-machine-learning">, <a href="../tag/machine-learning">Machine Learning</a></span><span class="post-tag-user-based-cf">, <a href="../tag/user-based-cf">User-based CF</a></span>
					</div>
				</div>
			</div>
			<br>
			<br>
			<br>



				<section class="post-content">
					<div class="post-reading">
						<span class="post-reading-time"></span> read
					</div>
					<a name="topofpage"></a>
					<p>In the last <a href="https://www.atindriyaghosh.com/recommendation-systems-2-similarity-scores/" title="Similarity Scores">post</a>, I covered three different algorithms for calculating similarity scores. Now, lets see how these similarity scores can be used to generate User-based recommendations.</p>

<h1 id="generatinguserbasedrecommendations">Generating User-based Recommendations</h1>

<p>Similarity scores help us understand the similarity between different users. Now, how do we use this similarity data to actually generate recommendations?</p>

<p>The easiest way is to select the most similar user, <em>User2</em>, to a specific user, <em>User1</em>, and recommend those items to <em>User1</em> which <em>User2</em> has rated highly but <em>User1</em> hasn't rated. </p>

<p>But, this approach has a lot of potential problems. Consider <em>User3</em> and <em>User4</em> to be the next most-similar users to <em>User1</em>. Suppose both these users give high ratings to an item <em>itemA</em>, that <em>User2</em> has not yet rated. Thus, <em>itemA</em> will not show up as a recommendation to <em>User1</em> even though there is a very good probability that she would rate it highly.</p>

<p>An extension of this problem is that <em>User2</em> gives <em>itemA</em> a poor rating. Again,  the recommendation system will not recommend <em>itemA</em> to <em>User1</em> even though <em>User3</em> and <em>User4</em> rate it highly.</p>

<p>These issues can be solved by recommending items based on a weighted score, which is calculating by multiplying their similarity scores to their rating for that item.</p>

<h2 id="example">Example</h2>

<p>Let us take an example to understand this better.</p>

<p>Consider we have a dataset of 5 users <em>User1</em>, <em>User2</em>, ..., <em>User5</em> and we have to generate recommendations for <em>User1</em>. </p>

<p>The below table shows the similarity scores of <em>User2</em>, ..., <em>User5</em> specific to <em>User1</em>, the ratings for each user for three movies not rated by <em>User1</em> ("<em>Solaris</em>", "<em>Alien</em>" and "<em>Children of Heaven</em>") and the calculated weighted score for each movie.</p>

<p><img src="../content/images/2015/02/Dataset.png" alt="Dataset" /></p>

<p>Thus, for <em>User2</em> the similarity score is <strong>0.99</strong> and the rating for the movie "<em>Solaris</em>" is <strong>3</strong> . Thus, the weighted score for "<em>Solaris</em>" for <em>User2</em> is <strong>2.97</strong> i.e. <code>similarity_score * rating</code>. Thus, the user with the higher similarity score will contribute more to the weighted score.</p>

<p>After calculating all the weighted scores for each user, we can then add them up to get the total weighted score for each movie. </p>

<p>This weighted score is then divided by the sum of the similarity scores for each user that rated that movie. This division ensures that movies that are rated by more users don't have an advantage over movies rated by less number of users.</p>

<p>Thus, for the movie "<em>Children of Heaven</em>", we divide the total weighted score by the sum of the similarities of <em>User2</em>, <em>User4</em> and <em>User5</em> since <em>User3</em> has not rated the movie.</p>

<p>This final weighted score is used to rank the movies, which can then be recommended to <em>User1</em>.</p>

<h2 id="implementation">Implementation</h2>

<p>The Python code to implement this is</p>

<pre><code>def genRecommendations(self, user, simAlgo, numRecs=3):
    """Generates recommendatons based on the following inputs
        1. User for whom recommendations are to be provided
        2. Recommendation algorithm to use
           eucl - Euclidian distance
           pearson - Pearson correlation
           cosine - Cosine similarity
        3. Maximum number of recommendations
    """
    totalWeights = {}
    simSum = {}
    for other_user in self._ratings.keys():
        if(user != other_user):
            # Calculate similarity scores according to passed algorithm
            # name.
            sim = self._calcSimilarity(user, other_user, simAlgo)
            if(sim &gt; 0):
                for movie in self._ratings[other_user]:
                    if movie not in self._ratings[user] and self._ratings[
                            other_user][movie] &gt; 0:
                        totalWeights.setdefault(movie, 0)
                        simSum.setdefault(movie, 0)
                        totalWeights[movie] += sim * \
                            self._ratings[other_user][movie]
                        simSum[movie] += sim

    recommMovies = [(movie, (weight / simSum[movie]))
                    for movie, weight in totalWeights.items()]

    recommMovies = sorted(recommMovies, key=lambda x: x[1])
    recommMovies.reverse()
    recommMovies = [(i + 1, self._items[movies[0]])
                    for i, movies in enumerate(recommMovies[:numRecs])]
    return recommMovies
</code></pre>

<p>The complete implementation of the User-based recommendation system can be found on <a href="https://github.com/atindriyaghosh/Collective-Intelligence/tree/master/recommendations" title="GitHub">Github</a>.</p>

<p>The data that I have tested against is the <a href="http://grouplens.org/datasets/movielens/" title="MovieLens Dataset">MovieLens Dataset</a> provided by <a href="http://grouplens.org/" title="GroupLens">GroupLens</a>. For ease of access, I have added the relevant data files in the above GitHub repository.</p>

<h1 id="conclusion">Conclusion</h1>

<p>The User-based recommendation system is widely used but it does present problems when it comes to scalability. In this system, the similarity scores have to be re-computed every time a user rates a new item. Thus, for millions of users, the rate of re-computation will be very high. Additionally, the amount of processing to be performed in each computation will be huge.</p>

<p>There are ways to alleviate these problems by offload the processing to a batch application or by calculating the weighted score with only the top N most similar users, but these approaches don't solve the fundamental scalability problems of this type of system.</p>

<p>Nowadays, projects mostly use this system as an initial implementation since it is easy to implement and works well with small datasets. As the project evolves and matures, the User-based recommendation system is replaced with more powerful alternatives.</p>

<h1 id="references">References</h1>

<ol>
<li><a href="http://www.amazon.com/Programming-Collective-Intelligence-Building-Applications/dp/0596529325" title="Programming Collective Intelligence">Programming Collective Intelligence</a>  </li>
<li><a href="http://guidetodatamining.com/" title="A Programmer's Guide to Data Mining">A Programmer's Guide to Data Mining</a></li>
</ol>

<h1 id="datasets">Datasets</h1>

<ol>
<li><a href="http://grouplens.org/datasets/movielens/" title="MovieLens Dataset">MovieLens Dataset</a></li>
</ol>
				</section>
				<footer class="post-footer">
					<section class="share">
						<a class="icon-twitter" href="http://twitter.com/share?text=Recommendation%20Systems%203%20-%20User-based%20Recommendations&url=https://www.atindriyaghosh.com/recommendation-systems-3-user-based-recommendations/"
							onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
							<span class="hidden">Twitter</span>
						</a>
						<a class="icon-facebook" href="https://www.facebook.com/sharer/sharer.php?u=https://www.atindriyaghosh.com/recommendation-systems-3-user-based-recommendations/"
							onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;">
							<span class="hidden">Facebook</span>
						</a>
						<a class="icon-google-plus" href="https://plus.google.com/share?url=https://www.atindriyaghosh.com/recommendation-systems-3-user-based-recommendations/"
						   onclick="window.open(this.href, 'google-plus-share', 'width=490,height=530');return false;">
							<span class="hidden">Google+</span>
						</a>
					</section>
				</footer>
				<div class="bottom-teaser cf">
					<div class="isLeft">
						<h5 class="index-headline featured"><span>Written by</span></h5>
						<section class="author">
							<div class="author-image" style="background-image: url(../content/images/2015/02/Self-1.jpg)">Blog Logo</div>
							<h4><a href="../author/atindriya-ghosh">Atindriya Ghosh</a></h4>
							<p class="bio">Atindriya is a Java Developer currently working with Accenture. He mostly works with and writes about Big Data Technologies</p>
							<hr>
							<p class="published">
								<a class="fa fa-twitter fa-2x" href="https://twitter.com/A3Ghosh" target="_blank">
								</a>
								<a class="fa fa-google-plus fa-2x" href="https://plus.google.com/+AtindriyaGhosh1989?rel=author" target="_blank">
								</a>
								<a class="fa fa-linkedin-square fa-2x" href="http://in.linkedin.com/in/atindriyaghosh/" target="_blank">
								</a>
								<a class="fa fa-github fa-2x" href="https://github.com/atindriyaghosh" target="_blank">
								</a>
								<a class="fa fa-rss-square fa-2x" href="http://feedpress.me/atindriyaghosh" target="_blank">
								</a>							
							</p>
						</section>
					</div>
					<div class="isRight">
						<h5 class="index-headline featured"><span>License</span></h5>
						<footer class="site-footer">
							<div class="inner">
								<section class="copyright"><a rel="license" href="http://creativecommons.org/licenses/by-nc/4.0/"><img alt="Creative Commons Licence" style="border-width:0" src="https://i.creativecommons.org/l/by-nc/4.0/88x31.png" /></a><br />&copy; 2015 by <a href="..">Atindriya Ghosh</a>.<br/>This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-nc/4.0/">Creative Commons Attribution-NonCommercial 4.0 International License</a>.</section>
								<br/>
							</div>
							<section class="poweredby">Proudly published with <a class="icon-ghost" href="http://ghost.org"> Ghost</a></section>
						</footer>
					</div>
				</div>
				
				<div id="disqus_thread"></div>
				<script type="text/javascript">
				    var disqus_shortname = 'atindriyaghosh'; // required: replace example with your forum shortname
				
				    (function() {
				        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
				        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
				        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
				    })();
				</script>
				<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>

		</article>
	</div>
</main>

<div class="bottom-closer">
    <div class="background-closer-image" style="background-image: url(../content/images/2015/02/2230472EC0-1.jpg)">
        Image
    </div>
    <div class="inner">
        <h1 class="blog-title">Atindriya Ghosh</h1>
        <h2 class="blog-description">Hi, I&#x27;m Atin and welcome to my blog! I primarily write about things I learn in my day job as a Java developer. Feel free to look around and share your thoughts.</h2>
        <a href=".." class="btn">Back to Home</a>
    </div>
</div>

	</div>
    <script src="../public/jquery.js"></script>
	
    <script type="text/javascript" src="../assets/js/jquery.fitvids.js"></script>
    <script type="text/javascript" src="../assets/js/index.js"></script>
    <script src="../assets/js/readingTime.min.js"></script>
    <script src="../assets/js/highlight.pack.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
	<script type="text/javascript" src="../assets/js/google-analytics.js"></script>
	
	<!-- Pushy JS -->
    <script type="text/javascript" src="../assets/js/min/pushy.min.js"></script>
	
	<!-- Ghosthunter JS -->
	<script type="text/javascript" src="../assets/js/min/jquery.ghostHunter.min.js"></script>
	<script type="text/javascript" src="../assets/js/ghostHunter-init.js"></script>
	
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">
            MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}});
    </script>

</body>
</html>
